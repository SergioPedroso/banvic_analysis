version: 2

sources:
  - name: banvic
    database: integracao-sheets-445219
    schema: dbt_banvic
    tables:
      - name: agencias
        description: Branch registry.
        columns:
          - name: cod_agencia
            description: Unique identifier of the branch.
            tests:
              - not_null
              - unique

      - name: clientes
        description: Customer registry.
        columns:
          - name: cod_cliente
            description: Unique identifier of the customer.
            tests: 
              - not_null
              - unique

      - name: colaborador_agencia
        description: Employee to branch key relationship.
        columns:
          - name: cod_colaborador
            description: FK to employees.
            tests: 
              - not_null
          - name: cod_agencia
            description: FK to branches.
            tests: 
              - not_null
        tests:
          - dbt_utils.unique_combination_of_columns:
              combination_of_columns: [cod_colaborador, cod_agencia]
              
      - name: colaboradores
        description: Employee registry.
        columns:
          - name: cod_colaborador
            description: Unique identifier of the employee.
            tests:
              - not_null
              - unique

      - name: contas
        description: Customer accounts.
        columns:
          - name: num_conta
            description: Unique identifier of the account.
            tests: 
              - not_null
              - unique
          - name: cod_cliente
            description: FK to customers.
            tests: 
              - not_null
          - name: cod_agencia
            description: FK to branch.
            tests: 
              - not_null
          - name: cod_colaborador
            description: FK to employee.
            tests: 
              - not_null

      - name: propostas_credito
        description: Credit proposals.
        columns:
          - name: cod_proposta
            description: Unique identifier of the proposal.
            tests: 
              - not_null
              - unique
          - name: cod_cliente
            description: FK to customers.
            tests: 
              - not_null
          - name: cod_colaborador
            description: FK to employee.
            tests: 
              - not_null

      - name: transacoes
        description: Financial transactions.
        columns:
          - name: cod_transacao
            description: Unique identifier of the transaction.
            tests: 
              - not_null
              - unique
          - name: num_conta
            description: FK to accounts.
            tests: 
              - not_null
