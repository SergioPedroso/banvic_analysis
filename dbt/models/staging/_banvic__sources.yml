version: 2

sources:
  - name: banvic
    database: integracao-sheets-445219
    schema: dbt_banvic
    tables:
      - name: agencias
        description: "Cadastro de agências."
        columns:
          - name: cod_agencia
            description: "Identificador único da agência."
            tests:
              - not_null
              - unique

      - name: clientes
        description: "Cadastro de clientes."
        columns:
          - name: cod_cliente
            description: "Identificador único do cliente."
            tests: 
              - not_null
              - unique

      - name: colaborador_agencia
        description: "Relação colaborador ↔ agência (lotação)."
        columns:
          - name: cod_colaborador
            description: "FK para colaboradores."
            tests: 
              - not_null
          - name: cod_agencia
            description: "FK para agencias."
            tests: 
              - not_null
        tests:
          - dbt_utils.unique_combination_of_columns:
              combination_of_columns: [cod_colaborador, cod_agencia]
              
      - name: colaboradores
        description: "Cadastro de colaboradores."
        columns:
          - name: cod_colaborador
            description: "Identificador único do colaborador."
            tests:
              - not_null
              - unique

      - name: contas
        description: "Contas de clientes."
        columns:
          - name: cod_conta
            description: "Identificador único da conta."
            tests: 
              - not_null
              - unique
          - name: cod_cliente
            description: "FK para clientes."
            tests: 
              - not_null
          - name: cod_agencia
            description: "FK para agencia."
            tests: 
              - not_null
          - name: cod_colaborador
            description: "FK para colaborador."
            tests: 
              - not_null

      - name: propostas_credito
        description: "Propostas de crédito."
        columns:
          - name: cod_proposta
            description: "Identificador único da proposta."
            tests: 
              - not_null
              - unique
          - name: cod_cliente
            description: "FK para clientes."
            tests: 
              - not_null
          - name: cod_colaborador
            description: "FK para colaborador."
            tests: 
              - not_null

      - name: transacoes
        description: "Transações financeiras."
        columns:
          - name: cod_transacao
            description: "Identificador único da transação."
            tests: 
              - not_null
              - unique
          - name: num_conta
            description: "FK para contas."
            tests: 
              - not_null